let SMART_CONTRACT_ADDRESS = "0x13A04C3DcC1856c4bdc102cEF799e03d56D7655A"

const networkDiv = document.getElementById('network')
const chainIdDiv = document.getElementById('chainId')
const accountsDiv = document.getElementById('accounts')
const connectButton = document.getElementById('connectButton')
const mintButton = document.getElementById('mintButton')
const amountPaid = document.getElementById('amountPaid')
const nftText = document.getElementById('nftText')
const loadCharactersSinclairButton = document.getElementById('loadCharactersSinclairButton')
const loadCharactersTinyFontButton = document.getElementById('loadCharactersTinyFontButton')
const tokenIdNumber = document.getElementById('tokenIdNumber')
const getTokenButton = document.getElementById('getTokenButton')
const howManyNftsButton = document.getElementById('howManyNftsButton')
const getNftsButton = document.getElementById('getNftsButton')
const addrTextArea = document.getElementById('addrTextArea')
const addToWhitelistButton = document.getElementById('addToWhitelistButton')

var sinclair_s_pixels = [5, 13, 21, 29, 37, 53, 4, 6, 12, 14, 11, 14, 18, 19, 20, 21, 22, 23, 27, 30, 35, 38, 42, 43, 44, 45, 46, 47, 51, 54, 4, 10, 11, 12, 13, 14, 18, 20, 26, 27, 28, 29, 30, 36, 38, 42, 43, 44, 45, 46, 52, 10, 11, 15, 18, 19, 22, 29, 36, 43, 46, 47, 50, 54, 55, 12, 19, 21, 28, 35, 37, 39, 42, 46, 51, 52, 53, 55, 13, 20, 13, 20, 28, 36, 44, 53, 12, 21, 29, 37, 45, 52, 19, 21, 28, 34, 35, 36, 37, 38, 44, 51, 53, 20, 28, 34, 35, 36, 37, 38, 44, 52, 45, 53, 60, 34, 35, 36, 37, 38, 44, 45, 52, 53, 22, 29, 36, 43, 50, 10, 11, 12, 13, 17, 21, 22, 25, 28, 30, 33, 35, 38, 41, 42, 46, 50, 51, 52, 53, 10, 11, 17, 19, 27, 35, 43, 49, 50, 51, 52, 53, 10, 11, 12, 13, 17, 22, 30, 34, 35, 36, 37, 41, 49, 50, 51, 52, 53, 54, 10, 11, 12, 13, 17, 22, 28, 29, 38, 41, 46, 50, 51, 52, 53, 12, 19, 20, 26, 28, 33, 36, 41, 42, 43, 44, 45, 46, 52, 9, 10, 11, 12, 13, 14, 17, 25, 26, 27, 28, 29, 38, 41, 46, 50, 51, 52, 53, 10, 11, 12, 13, 17, 25, 26, 27, 28, 29, 33, 38, 41, 46, 50, 51, 52, 53, 9, 10, 11, 12, 13, 14, 22, 29, 36, 43, 51, 10, 11, 12, 13, 17, 22, 26, 27, 28, 29, 33, 38, 41, 46, 50, 51, 52, 53, 10, 11, 12, 13, 17, 22, 25, 30, 34, 35, 36, 37, 38, 46, 50, 51, 52, 53, 28, 52, 20, 44, 52, 59, 21, 28, 35, 44, 53, 26, 27, 28, 29, 30, 42, 43, 44, 45, 46, 19, 28, 37, 44, 51, 11, 12, 13, 14, 18, 23, 30, 37, 53, 11, 12, 13, 14, 18, 21, 23, 26, 28, 30, 31, 34, 36, 37, 38, 39, 42, 51, 52, 53, 54, 10, 11, 12, 13, 17, 22, 25, 30, 33, 34, 35, 36, 37, 38, 41, 46, 49, 54, 9, 10, 11, 12, 13, 17, 22, 25, 26, 27, 28, 29, 33, 38, 41, 46, 49, 50, 51, 52, 53, 10, 11, 12, 13, 17, 22, 25, 33, 41, 46, 50, 51, 52, 53, 9, 10, 11, 12, 17, 21, 25, 30, 33, 38, 41, 45, 49, 50, 51, 52, 9, 10, 11, 12, 13, 14, 17, 25, 26, 27, 28, 29, 33, 41, 49, 50, 51, 52, 53, 54, 9, 10, 11, 12, 13, 14, 17, 25, 26, 27, 28, 29, 33, 41, 49, 10, 11, 12, 13, 17, 22, 25, 33, 36, 37, 38, 41, 46, 50, 51, 52, 53, 9, 14, 17, 22, 25, 26, 27, 28, 29, 30, 33, 38, 41, 46, 49, 54, 10, 11, 12, 13, 14, 20, 28, 36, 44, 50, 51, 52, 53, 54, 14, 22, 30, 33, 38, 41, 46, 50, 51, 52, 53, 9, 13, 17, 20, 25, 26, 27, 33, 36, 41, 45, 49, 54, 9, 17, 25, 33, 41, 49, 50, 51, 52, 53, 54, 9, 14, 17, 18, 21, 22, 25, 27, 28, 30, 33, 38, 41, 46, 49, 54, 9, 14, 17, 18, 22, 25, 27, 30, 33, 36, 38, 41, 45, 46, 49, 54, 10, 11, 12, 13, 17, 22, 25, 30, 33, 38, 41, 46, 50, 51, 52, 53, 9, 10, 11, 12, 13, 17, 22, 25, 30, 33, 34, 35, 36, 37, 41, 49, 10, 11, 12, 13, 17, 22, 25, 30, 33, 35, 38, 41, 44, 46, 50, 51, 52, 53, 9, 10, 11, 12, 13, 17, 22, 25, 30, 33, 34, 35, 36, 37, 41, 45, 49, 54, 10, 11, 12, 13, 17, 26, 27, 28, 29, 38, 41, 46, 50, 51, 52, 53, 9, 10, 11, 12, 13, 14, 15, 20, 28, 36, 44, 52, 9, 14, 17, 22, 25, 30, 33, 38, 41, 46, 50, 51, 52, 53, 9, 14, 17, 22, 25, 30, 33, 38, 42, 45, 51, 52, 9, 14, 17, 22, 25, 30, 33, 38, 41, 43, 44, 46, 50, 53, 9, 14, 18, 21, 27, 28, 35, 36, 42, 45, 49, 54, 9, 15, 18, 22, 27, 29, 36, 44, 52, 9, 10, 11, 12, 13, 14, 21, 28, 35, 42, 49, 50, 51, 52, 53, 54, 11, 12, 13, 19, 27, 35, 43, 51, 52, 53, 18, 27, 36, 45, 54, 11, 12, 13, 21, 29, 37, 45, 51, 52, 53, 12, 19, 20, 21, 26, 28, 30, 36, 44, 52, 57, 58, 59, 60, 61, 62, 63, 3, 4, 5, 6, 10, 15, 17, 20, 21, 25, 27, 33, 35, 41, 44, 45, 50, 55, 59, 60, 61, 62, 19, 20, 21, 30, 35, 36, 37, 38, 42, 46, 51, 52, 53, 54, 10, 18, 26, 27, 28, 29, 34, 38, 42, 46, 50, 51, 52, 53, 20, 21, 22, 27, 35, 43, 52, 53, 54, 14, 22, 27, 28, 29, 30, 34, 38, 42, 46, 51, 52, 53, 54, 19, 20, 21, 26, 30, 34, 35, 36, 37, 42, 51, 52, 53, 54, 13, 14, 20, 28, 29, 36, 44, 52, 19, 20, 21, 22, 23, 26, 31, 34, 39, 43, 44, 45, 46, 47, 55, 59, 60, 61, 62, 10, 18, 26, 27, 28, 29, 34, 38, 42, 46, 50, 54, 13, 28, 29, 37, 45, 52, 53, 54, 14, 30, 38, 46, 51, 54, 60, 61, 10, 18, 20, 26, 27, 34, 35, 42, 44, 50, 53, 12, 20, 28, 36, 44, 53, 54, 18, 19, 21, 26, 28, 30, 34, 36, 38, 42, 44, 46, 50, 52, 54, 18, 19, 20, 21, 26, 30, 34, 38, 42, 46, 50, 54, 19, 20, 21, 26, 30, 34, 38, 42, 46, 51, 52, 53, 18, 19, 20, 21, 26, 30, 34, 38, 42, 43, 44, 45, 50, 58, 19, 20, 21, 22, 26, 30, 34, 38, 43, 44, 45, 46, 54, 62, 63, 20, 21, 22, 27, 35, 43, 51, 19, 20, 21, 26, 35, 36, 37, 46, 50, 51, 52, 53, 12, 19, 20, 21, 28, 36, 44, 53, 54, 18, 22, 26, 30, 34, 38, 42, 46, 51, 52, 53, 18, 22, 26, 30, 35, 37, 43, 45, 52, 18, 22, 26, 28, 30, 34, 36, 38, 42, 44, 46, 51, 53, 18, 22, 27, 29, 36, 43, 45, 50, 54, 18, 22, 26, 30, 34, 38, 43, 44, 45, 46, 54, 59, 60, 61, 18, 19, 20, 21, 22, 29, 36, 43, 50, 51, 52, 53, 54, 12, 13, 14, 20, 26, 27, 36, 44, 52, 53, 54, 12, 20, 28, 36, 44, 52, 10, 11, 12, 20, 29, 30, 36, 44, 50, 51, 52, 12, 14, 19, 21];
var sinclair_s_indexes = [0, 6, 10, 30, 51, 65, 78, 80, 86, 92, 103, 112, 115, 120, 124, 129, 149, 161, 179, 194, 208, 227, 245, 256, 274, 292, 294, 298, 303, 313, 318, 327, 348, 366, 387, 401, 417, 437, 452, 469, 485, 499, 510, 523, 534, 550, 566, 582, 598, 616, 634, 650, 662, 676, 688, 702, 714, 723, 739, 749, 754, 764, 774, 781, 803, 817, 831, 840, 854, 868, 876, 895, 907, 915, 923, 934, 941, 956, 968, 980, 994, 1009, 1016, 1028, 1037, 1048, 1057, 1070, 1079, 1093, 1106, 1117, 1123, 1134];

var tinyfont_pixels = [4, 5, 11, 12, 13, 14, 19, 20, 21, 22, 28, 29, 36, 37, 52, 53, 2, 3, 6, 7, 10, 11, 14, 15, 19, 22, 2, 3, 5, 6, 10, 11, 13, 14, 17, 18, 19, 20, 21, 22, 23, 26, 27, 29, 30, 33, 34, 35, 36, 37, 38, 39, 42, 43, 45, 46, 50, 51, 53, 54, 4, 5, 11, 12, 13, 14, 15, 18, 19, 27, 28, 29, 30, 38, 39, 42, 43, 44, 45, 46, 52, 53, 9, 10, 14, 15, 17, 18, 21, 22, 28, 29, 35, 36, 42, 43, 46, 47, 49, 50, 54, 55, 3, 4, 5, 10, 11, 13, 14, 19, 20, 21, 26, 27, 28, 30, 31, 33, 34, 36, 37, 38, 41, 42, 45, 46, 50, 51, 52, 54, 55, 4, 5, 12, 13, 19, 20, 5, 6, 12, 13, 19, 20, 27, 28, 35, 36, 44, 45, 53, 54, 3, 4, 12, 13, 21, 22, 29, 30, 37, 38, 44, 45, 51, 52, 10, 11, 14, 15, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 35, 36, 37, 38, 42, 43, 46, 47, 12, 13, 20, 21, 26, 27, 28, 29, 30, 31, 36, 37, 44, 45, 44, 45, 52, 53, 59, 60, 26, 27, 28, 29, 30, 31, 44, 45, 52, 53, 6, 7, 13, 14, 20, 21, 27, 28, 34, 35, 41, 42, 49, 2, 3, 4, 5, 6, 9, 10, 14, 15, 17, 18, 21, 22, 23, 25, 26, 28, 30, 31, 33, 34, 35, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 4, 5, 11, 12, 13, 20, 21, 28, 29, 36, 37, 44, 45, 50, 51, 52, 53, 54, 55, 2, 3, 4, 5, 6, 9, 10, 14, 15, 22, 23, 28, 29, 30, 35, 36, 42, 43, 46, 47, 49, 50, 51, 52, 53, 54, 55, 2, 3, 4, 5, 6, 9, 10, 14, 15, 22, 23, 27, 28, 29, 30, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 4, 5, 6, 11, 12, 13, 14, 18, 19, 21, 22, 25, 26, 29, 30, 33, 34, 35, 36, 37, 38, 39, 45, 46, 52, 53, 54, 55, 1, 2, 3, 4, 5, 6, 7, 9, 10, 17, 18, 25, 26, 27, 28, 29, 30, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 3, 4, 5, 10, 11, 17, 18, 25, 26, 27, 28, 29, 30, 33, 34, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 1, 2, 3, 4, 5, 6, 7, 9, 10, 14, 15, 21, 22, 28, 29, 35, 36, 43, 44, 51, 52, 2, 3, 4, 5, 6, 9, 10, 14, 15, 17, 18, 22, 23, 26, 27, 28, 29, 30, 33, 34, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 2, 3, 4, 5, 6, 9, 10, 14, 15, 17, 18, 22, 23, 26, 27, 28, 29, 30, 31, 38, 39, 45, 46, 50, 51, 52, 53, 12, 13, 20, 21, 44, 45, 52, 53, 12, 13, 20, 21, 44, 45, 52, 53, 59, 60, 6, 7, 13, 14, 20, 21, 27, 28, 36, 37, 45, 46, 54, 55, 18, 19, 20, 21, 22, 23, 42, 43, 44, 45, 46, 47, 2, 3, 11, 12, 20, 21, 29, 30, 36, 37, 43, 44, 50, 51, 2, 3, 4, 5, 6, 9, 10, 14, 15, 21, 22, 28, 29, 36, 37, 52, 53, 2, 3, 4, 5, 6, 9, 10, 14, 15, 17, 18, 20, 21, 22, 23, 25, 26, 28, 29, 30, 31, 33, 34, 36, 37, 38, 39, 41, 42, 50, 51, 52, 53, 3, 4, 5, 10, 11, 13, 14, 17, 18, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 38, 39, 41, 42, 46, 47, 49, 50, 54, 55, 1, 2, 3, 4, 5, 6, 10, 11, 14, 15, 18, 19, 22, 23, 26, 27, 28, 29, 30, 34, 35, 38, 39, 42, 43, 46, 47, 49, 50, 51, 52, 53, 54, 3, 4, 5, 6, 10, 11, 14, 15, 17, 18, 25, 26, 33, 34, 42, 43, 46, 47, 51, 52, 53, 54, 1, 2, 3, 4, 5, 10, 11, 13, 14, 18, 19, 22, 23, 26, 27, 30, 31, 34, 35, 38, 39, 42, 43, 45, 46, 49, 50, 51, 52, 53, 1, 2, 3, 4, 5, 6, 7, 10, 11, 15, 18, 19, 21, 26, 27, 28, 29, 34, 35, 37, 42, 43, 47, 49, 50, 51, 52, 53, 54, 55, 1, 2, 3, 4, 5, 6, 7, 10, 11, 15, 18, 19, 21, 26, 27, 28, 29, 34, 35, 37, 42, 43, 49, 50, 51, 52, 3, 4, 5, 6, 10, 11, 14, 15, 17, 18, 25, 26, 33, 34, 37, 38, 39, 42, 43, 46, 47, 51, 52, 53, 55, 1, 2, 6, 7, 9, 10, 14, 15, 17, 18, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 38, 39, 41, 42, 46, 47, 49, 50, 54, 55, 3, 4, 5, 6, 12, 13, 20, 21, 28, 29, 36, 37, 44, 45, 51, 52, 53, 54, 4, 5, 6, 7, 13, 14, 21, 22, 29, 30, 33, 34, 37, 38, 41, 42, 45, 46, 50, 51, 52, 53, 1, 2, 3, 6, 7, 10, 11, 14, 15, 18, 19, 21, 22, 26, 27, 28, 29, 34, 35, 37, 38, 42, 43, 46, 47, 49, 50, 51, 54, 55, 1, 2, 3, 4, 10, 11, 18, 19, 26, 27, 34, 35, 39, 42, 43, 46, 47, 49, 50, 51, 52, 53, 54, 55, 1, 2, 6, 7, 9, 10, 11, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 36, 38, 39, 41, 42, 46, 47, 49, 50, 54, 55, 1, 2, 6, 7, 9, 10, 11, 14, 15, 17, 18, 19, 20, 22, 23, 25, 26, 28, 29, 30, 31, 33, 34, 37, 38, 39, 41, 42, 46, 47, 49, 50, 54, 55, 2, 3, 4, 5, 6, 9, 10, 14, 15, 17, 18, 22, 23, 25, 26, 30, 31, 33, 34, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 1, 2, 3, 4, 5, 6, 10, 11, 14, 15, 18, 19, 22, 23, 26, 27, 28, 29, 30, 34, 35, 42, 43, 49, 50, 51, 52, 2, 3, 4, 5, 6, 9, 10, 14, 15, 17, 18, 22, 23, 25, 26, 30, 31, 33, 34, 38, 39, 41, 42, 45, 46, 47, 50, 51, 52, 53, 54, 61, 62, 63, 1, 2, 3, 4, 5, 6, 10, 11, 14, 15, 18, 19, 22, 23, 26, 27, 28, 29, 30, 34, 35, 37, 38, 42, 43, 46, 47, 49, 50, 51, 54, 55, 2, 3, 4, 5, 6, 9, 10, 14, 15, 18, 19, 27, 28, 29, 37, 38, 41, 42, 46, 47, 50, 51, 52, 53, 54, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 18, 20, 21, 23, 28, 29, 36, 37, 44, 45, 51, 52, 53, 54, 1, 2, 6, 7, 9, 10, 14, 15, 17, 18, 22, 23, 25, 26, 30, 31, 33, 34, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 1, 2, 6, 7, 9, 10, 14, 15, 17, 18, 22, 23, 25, 26, 30, 31, 33, 34, 38, 39, 42, 43, 45, 46, 51, 52, 53, 1, 2, 6, 7, 9, 10, 14, 15, 17, 18, 22, 23, 25, 26, 28, 30, 31, 33, 34, 36, 38, 39, 41, 42, 43, 44, 45, 46, 47, 50, 51, 53, 54, 1, 2, 6, 7, 9, 10, 14, 15, 18, 19, 21, 22, 27, 28, 29, 34, 35, 37, 38, 41, 42, 46, 47, 49, 50, 54, 55, 2, 3, 6, 7, 10, 11, 14, 15, 18, 19, 22, 23, 27, 28, 29, 30, 36, 37, 44, 45, 51, 52, 53, 54, 1, 2, 3, 4, 5, 6, 7, 9, 10, 14, 15, 17, 21, 22, 28, 29, 35, 36, 39, 42, 43, 46, 47, 49, 50, 51, 52, 53, 54, 55, 3, 4, 5, 6, 11, 12, 19, 20, 27, 28, 35, 36, 43, 44, 51, 52, 53, 54, 1, 2, 10, 11, 19, 20, 28, 29, 37, 38, 46, 47, 55, 3, 4, 5, 6, 13, 14, 21, 22, 29, 30, 37, 38, 45, 46, 51, 52, 53, 54, 4, 11, 12, 13, 18, 19, 21, 22, 25, 26, 30, 31, 57, 58, 59, 60, 61, 62, 63, 3, 4, 12, 13, 21, 22, 18, 19, 20, 21, 29, 30, 34, 35, 36, 37, 38, 41, 42, 45, 46, 50, 51, 52, 54, 55, 1, 2, 3, 10, 11, 18, 19, 20, 21, 22, 26, 27, 30, 31, 34, 35, 38, 39, 42, 43, 46, 47, 49, 50, 52, 53, 54, 18, 19, 20, 21, 22, 25, 26, 30, 31, 33, 34, 41, 42, 46, 47, 50, 51, 52, 53, 54, 4, 5, 6, 13, 14, 18, 19, 20, 21, 22, 25, 26, 29, 30, 33, 34, 37, 38, 41, 42, 45, 46, 50, 51, 52, 54, 55, 18, 19, 20, 21, 22, 25, 26, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 50, 51, 52, 53, 54, 3, 4, 5, 6, 10, 11, 14, 15, 18, 19, 25, 26, 27, 28, 29, 34, 35, 42, 43, 49, 50, 51, 52, 18, 19, 20, 22, 23, 25, 26, 29, 30, 33, 34, 37, 38, 42, 43, 44, 45, 46, 53, 54, 57, 58, 59, 60, 61, 1, 2, 3, 10, 11, 18, 19, 21, 22, 26, 27, 28, 30, 31, 34, 35, 38, 39, 42, 43, 46, 47, 49, 50, 51, 54, 55, 4, 5, 19, 20, 21, 28, 29, 36, 37, 44, 45, 51, 52, 53, 54, 6, 7, 22, 23, 30, 31, 38, 39, 42, 43, 46, 47, 50, 51, 54, 55, 59, 60, 61, 62, 1, 2, 3, 10, 11, 18, 19, 22, 23, 26, 27, 29, 30, 34, 35, 36, 37, 42, 43, 45, 46, 49, 50, 51, 54, 55, 3, 4, 5, 12, 13, 20, 21, 28, 29, 36, 37, 44, 45, 51, 52, 53, 54, 17, 18, 19, 21, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 36, 38, 39, 41, 42, 44, 46, 47, 49, 50, 52, 54, 55, 17, 18, 20, 21, 22, 26, 27, 30, 31, 34, 35, 38, 39, 42, 43, 46, 47, 50, 51, 54, 55, 18, 19, 20, 21, 22, 25, 26, 30, 31, 33, 34, 38, 39, 41, 42, 46, 47, 50, 51, 52, 53, 54, 17, 18, 20, 21, 22, 26, 27, 30, 31, 34, 35, 38, 39, 42, 43, 44, 45, 46, 50, 51, 57, 58, 59, 60, 18, 19, 20, 22, 23, 25, 26, 29, 30, 33, 34, 37, 38, 42, 43, 44, 45, 46, 53, 54, 60, 61, 62, 63, 17, 18, 20, 21, 22, 26, 27, 28, 30, 31, 34, 35, 42, 43, 49, 50, 51, 52, 18, 19, 20, 21, 22, 23, 25, 26, 34, 35, 36, 37, 38, 46, 47, 49, 50, 51, 52, 53, 54, 3, 4, 11, 12, 17, 18, 19, 20, 21, 22, 27, 28, 35, 36, 43, 44, 46, 47, 52, 53, 54, 17, 18, 21, 22, 25, 26, 29, 30, 33, 34, 37, 38, 41, 42, 45, 46, 50, 51, 52, 54, 55, 17, 18, 22, 23, 25, 26, 30, 31, 33, 34, 38, 39, 42, 43, 45, 46, 51, 52, 53, 17, 18, 22, 23, 25, 26, 28, 30, 31, 33, 34, 36, 38, 39, 41, 42, 43, 44, 45, 46, 47, 50, 51, 53, 54, 17, 18, 22, 23, 26, 27, 29, 30, 35, 36, 37, 42, 43, 45, 46, 49, 50, 54, 55, 17, 18, 22, 23, 25, 26, 30, 31, 33, 34, 38, 39, 42, 43, 44, 45, 46, 47, 54, 55, 57, 58, 59, 60, 61, 62, 18, 19, 20, 21, 22, 23, 26, 29, 30, 36, 37, 43, 44, 47, 50, 51, 52, 53, 54, 55, 5, 6, 7, 12, 13, 20, 21, 26, 27, 28, 36, 37, 44, 45, 53, 54, 55, 4, 5, 12, 13, 20, 21, 28, 29, 36, 37, 44, 45, 52, 53, 2, 3, 4, 12, 13, 20, 21, 29, 30, 31, 36, 37, 44, 45, 50, 51, 52, 2, 3, 4, 6, 7, 9, 10, 12, 13, 14];
var tinyfont_indexes = [0, 16, 26, 60, 82, 102, 131, 137, 151, 165, 188, 202, 208, 214, 218, 231, 264, 283, 310, 336, 364, 392, 418, 439, 470, 497, 505, 515, 529, 541, 555, 572, 605, 635, 668, 690, 720, 750, 776, 801, 832, 850, 872, 902, 926, 963, 997, 1027, 1054, 1088, 1120, 1145, 1171, 1200, 1227, 1260, 1287, 1311, 1341, 1359, 1372, 1390, 1402, 1409, 1415, 1435, 1462, 1482, 1509, 1532, 1555, 1580, 1607, 1622, 1642, 1668, 1685, 1712, 1733, 1755, 1779, 1803, 1821, 1842, 1863, 1884, 1903, 1928, 1947, 1973, 1993, 2010, 2024, 2041];

const isMetaMaskInstalled = () => {
    const {
        ethereum
    } = window
    return Boolean(ethereum && ethereum.isMetaMask)
}

const isMetaMaskConnected = () => accounts && accounts.length > 0

let web3;
let accounts;
let contract;

async function connectWallet() {
    try {
        web3 = await getWeb3();
        console.log("web3",
            web3);
        accounts = await web3.eth.getAccounts();
        console.log("accounts",
            accounts);
        contract = await getContract(web3);
        console.log("contract",
            contract);
        $("#result").html("")
        $("#smartContractInteractionSection").show()
        accountsDiv.innerHTML = accounts;
        getNetworkAndChainId();
    } catch (error) {
        console.log(error)
    }
}

async function getNetworkAndChainId() {
    try {
        const chainId = await ethereum.request({
            method: 'eth_chainId',
        })
        chainIdDiv.innerHTML = chainId

        const networkId = await ethereum.request({
            method: 'net_version',
        })
        networkDiv.innerHTML = networkId
        $("#connectButtonRow").hide()
    } catch (err) {
        console.error(err)
    }
}

async function mintNfts() {
    let test = await contract.methods.mintNft(nftText.value).send({
            to: SMART_CONTRACT_ADDRESS,
            from: accounts[0],
            value: (1000000000000000000) * amountPaid.value
        })
        .on('receipt', function() {
            console.log("receipt")
        });
    var str = JSON.stringify(test, null, 2);
    $("#result").html(str)
}

async function setBaseUri() {
    let test = await contract.methods.setBaseURI(baseUriText.value).send({
            from: accounts[0]
        })
        .on('receipt', function() {
            console.log("receipt")
        })
    var str = JSON.stringify(test, null, 2);
    $("#result").html(str)
}

async function toggleSale() {
    let test = await contract.methods.toggleSale().send({
            from: accounts[0]
        })
        .on('receipt', function() {
            console.log("receipt")
        });
    var str = JSON.stringify(test, null, 2);
    $("#result").html(str)
}

async function togglePreSale() {
    let test = await contract.methods.togglePreSale().send({
            from: accounts[0]
        })
        .on('receipt', function() {
            console.log("receipt")
        })
    var str = JSON.stringify(test, null, 2);
    $("#result").html(str)
}

async function getHowManyNfts() {
    let balanceOwner = await contract.methods.balanceOf(accounts[0]).call();
    console.log(balanceOwner)
    var str = JSON.stringify(balanceOwner, null, 2);
    $("#result").html("The address " + accounts[0] + " has " + str + " tokens")
    contract.methods.totalSupply().call().then(x => {
        for (var i = 0; i < x; i++) {
            //const nft = await contract.methods.YourSmartContract(i).call();
            contract.methods.ownerOf(i).call().then(owner => {
                // if match with this address is found
                if (accounts[0] === owner) {
                    console.log(i)
                } else {
                    console.log("miss")
                }
            })
        }
    }).catch(x => {
        console.log(x)
    })
}

async function getToken() {
    let test = await contract.methods.tokenURI(parseInt(tokenIdNumber.value)).call();
    console.log(test);
    var str = JSON.stringify(test, null, 2);
    $("#result").html(str)
}

async function getNfts() {
    var tokenIds = [];
    let totalSupply = await contract.methods.totalSupply().call();
    document.getElementById("cards-row").innerHTML = ""
    $("#nftSection").show()
    for (var i = 0; i < totalSupply; i++) {
        let owner = await contract.methods.ownerOf(i + 1).call();
        if (accounts[0] === owner) {
            let tokenUri = await contract.methods.tokenURI(i + 1).call();
            tokenIds.push(tokenUri);
            $.ajax({
                url: tokenUri,
                type: 'GET',
                dataType: 'json',
                async: false,
                success: function(jsonData, status) {
                    //console.log(jsonData)
                    var node = document.createElement("div");
                    node.className = "col-xl-4 col-lg-6 col-md-12 col-sm-12 col-12 mt-2 mb-2"
                    node.innerHTML = '<div class="card" style="width: 18rem;"><img class="card-img-top" src="' + jsonData.image + '" alt="' + jsonData.name + '"><div class="card-body"><h5 class="card-title">' + jsonData.name + '</h5><p class="card-text">' + jsonData.description + '</p></div></div>'
                    document.getElementById("cards-row").appendChild(node)
                }
            });
        }
    }
    console.log(tokenIds);
    $("#result").html(tokenIds.toString())
}

function initialize() {
    connectButton.onclick = async() => {
        connectWallet()
    }
    mintButton.onclick = async() => {
        mintNfts()
    }
    loadCharactersTinyFontButton.onclick = async() => {
        console.log("Loading chars TinyFont");
    }
    loadCharactersSinclairButton.onclick = async() => {
        console.log("Loading chars Sinclair");
    }
    getTokenButton.onclick = async() => {
        getToken()
    }
    howManyNftsButton.onclick = async() => {
        getHowManyNfts()
    }
    getNftsButton.onclick = async() => {
        getNfts()
    }
    getNftsButton.onclick = async() => {
        getNfts()
    }
}